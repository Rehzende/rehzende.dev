<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Marcos Rezende</title><link>https://rehzende.dev/</link><description>Recent content on Marcos Rezende</description><generator>Hugo -- gohugo.io</generator><language>pt-br</language><lastBuildDate>Sat, 25 Sep 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://rehzende.dev/index.xml" rel="self" type="application/rss+xml"/><item><title>1 - Drops: Pipelines — YML</title><link>https://rehzende.dev/p/1-drops-pipelines-yml/</link><pubDate>Sat, 25 Sep 2021 00:00:00 +0000</pubDate><guid>https://rehzende.dev/p/1-drops-pipelines-yml/</guid><description>&lt;img src="https://rehzende.dev/p/1-drops-pipelines-yml/yml.png" alt="Featured image of post 1 - Drops: Pipelines — YML" />&lt;p>Para continuar nossa jornada de Azure Pipelines, precisamos entender o mínimo de YML. A maioria das ferramentas de pipelines utiliza o YML como padrão de serialização (codificação de dados). Por isso, entender o mínimo já nos ajuda evitar alguns erros no momento de executar qualquer pipeline.&lt;/p>
&lt;p>Vou abordar de maneira simples o YML para facilitar o entendimento de quem está começando. Podemos salvar o arquivo em duas extensões: .yml ou .yaml as duas formas são reconhecidas; a boa prática é sempre usar em lowcase.&lt;/p>
&lt;p>&lt;strong>Dica:&lt;/strong> espaço em YML é muito importante, por isso sempre use um PAR de espaços e não Tab; quando precisar comentar use o #(hash).&lt;/p>
&lt;pre>&lt;code># seu comentário
&lt;/code>&lt;/pre>&lt;p>Para iniciar um documento temos uma opção que não é obrigatória, porém útil quando estamos trabalhando com mais de uma definição por arquivo. Iniciamos o arquivo com 3 hifens e finalizamos com 3 pontos.`&lt;/p>
&lt;pre>&lt;code>---
#só um comentário
...
&lt;/code>&lt;/pre>&lt;p>Mapeamento permite listar chaves com valores. Isso é útil nos casos em que você está atribuindo um nome ou uma propriedade a um elemento específico.&lt;/p>
&lt;pre>&lt;code>cerveja: tecnologia
copo: campo
&lt;/code>&lt;/pre>&lt;p>Às vezes precisamos trabalhar com listas e dicionários. Abaixo deixo dois exemplos do que eles são:
Listas são coleções de itens que você define usando hífen:&lt;/p>
&lt;pre>&lt;code>---
---
- apenas comece
- entenda os conceitos
- estude no seu tempo---
ferramentas:
- docker
- kubernetes
- terraform
- ansible
&lt;/code>&lt;/pre>&lt;p>Dicionários são coleções de mapeamentos de chave: valor. No exemplo abaixo, em que eu estou mapeando os dados de um pagador, tenho diversos dados, como: ‘pessoa’, ‘família’ e ‘endereço’. Porém, dentro de ‘endereço’ possuo outros dados. Isso tudo é um dicionário.&lt;/p>
&lt;pre>&lt;code>pagador: &amp;amp;id001
pessoa: Chris
familia: Dumars
endereco:
rua: |
458 Walkman Dr.
Suite #292
cidade: Royal Oak
estado: MI
cep: 48046
&lt;/code>&lt;/pre>&lt;p>Existem casos que repetimos os mesmos dados em diversas linhas de nosso código. Para evitar que o tamanho do documento fique muito grande, podemos repetir esse código trabalhando com âncoras. Basta usar ‘E’ Comercial &amp;amp;+String para criar uma âncora e usar asterisco *+String para criar a referência da âncora. Veja abaixo:&lt;/p>
&lt;pre>&lt;code>copodecerveja: &amp;amp;tecnologia
- dados_disponiveis: 2.5M
- usuarios_conectados: 39k
- linhas_de_codigos: &amp;quot;+10.216.248&amp;quot;
- squads: &amp;quot;+50&amp;quot;
- produtos:&amp;quot;+70&amp;quot;
mesadobar: *tecnologia # Aqui estamos dizendo que a mesadobar tem os mesmos dados do copodecerveja
&lt;/code>&lt;/pre>&lt;p>Podemos também usar multilinhas para atribuir nossos valores, usando: |(pipe) um bloco literal que irá inserir quebras de linhas em seu texto. E &amp;gt;(maior) bloco dobrado que irá substituir todas as quebras de linhas por espaços simples.&lt;/p>
&lt;pre>&lt;code>---
literal: |
do código ao campo
do campo ao código
---
dobrado: &amp;gt;
do código ao campo
do campo à mesa do bar
...
# Se convertermos esses dois exemplos em JSON, podemos ver melhor o que quis dizer.
{
&amp;quot;literal&amp;quot;: &amp;quot;do código ao campo\ndo campo ao código\n&amp;quot;,
&amp;quot;dobrado&amp;quot;: &amp;quot;do código ao campo do campo à mesa do bar\n&amp;quot;
}
Vou deixar um exemplo de uma ordem de venda que contém dados da operação.
---
&lt;/code>&lt;/pre>&lt;pre>&lt;code>nota_fiscal: 34843
data: 2001-01-23
pagador: &amp;amp;id001
pessoa: Chris
familia: Dumars
endereco:
rua: |
458 Walkman Dr.
Suite #292
cidade: Royal Oak
estado: MI
cep: 48046
envio: *id001
produto:
- id_produto: BL394D
quantidade: 4
descricao : Basketball
preco: 450.00
- id_produto: BL4438H
quantidade : 1
descricao: Super Hoop
preco: 2392.00
taxa : 251.42
total: 4443.52
...
&lt;/code>&lt;/pre>&lt;p>No dia-dia, o yml salva nossas vidas por ser simples e poderoso ao mesmo tempo. Quando se trata de pipelines, o yml ajuda a reduzir a curva de aprendizagem de qualquer ferramenta por ser fácil de ler e entender.&lt;/p>
&lt;p>Espero que tenha te ajudado, nos vemos em breve na sequência da nossa jornada em Azure Pipelines. Valeu!&lt;/p></description></item><item><title>2 - Drops: Azure Pipelines - Estrutura</title><link>https://rehzende.dev/p/2-drops-azure-pipelines-estrutura/</link><pubDate>Sat, 25 Sep 2021 00:00:00 +0000</pubDate><guid>https://rehzende.dev/p/2-drops-azure-pipelines-estrutura/</guid><description>&lt;img src="https://rehzende.dev/p/2-drops-azure-pipelines-estrutura/pipelines.png" alt="Featured image of post 2 - Drops: Azure Pipelines - Estrutura" />&lt;p>Posso dizer, sem dúvidas, que o mais assustador para alguém que está começando no universo de Devops e se vê diante de uma pipeline complexa, são os termos STAGE, STEP e JOBS. Até que consiga entender qual é a hierarquia deles, a pessoa pode ficar bem perdida.
Para ficar mais fácil de entender, a documentação da Microsoft traz vários exemplos e um deles vou reproduzir abaixo.
hierarquia-pipeline.yml&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="w"> &lt;/span>&lt;span class="nt">STAGE A&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">JOB 1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">STEP 1.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">STEP 1.2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">JOB 2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">STEP 2.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">STEP 2.2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">STAGE B&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>exemplo.pipeline.yml&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="w"> &lt;/span>&lt;span class="nt">stages&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">stage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Build &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">job&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">BuildJob &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">echo Building! &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">stage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Test &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">job&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TestOnWindows &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">echo Testing on Windows! &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">job&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TestOnLinux &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">echo Testing on Linux! &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">stage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Deploy &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">job&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Deploy &lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">echo Deploying the code!&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>STAGE é a coleção principal que contém todos os Jobs que devem ser executados. Por padrão, os stages nas pipelines são executados na sequência se o estágio anterior terminar com sucesso; caso contrário, a pipeline falhará ou os stages podem ser condicionadas a rodarem com dependência em um determinado estágio usando o dependeOn.&lt;/li>
&lt;li>JOB é uma coleção de etapas que, em uma pipeline, podemos usar para executar diferentes tipos de testes, builds ou o que for preciso em máquinas ou versões de sistemas operacionais diferentes. Isso porque, pra cada JOB você pode definir um AGENT POOL. Com o Agent Pool você pode escolher o sistema operacional em que a pipeline irá rodar determinado Job, podendo ser em Vms ou até mesmo Containers.&lt;/li>
&lt;li>STEPS são as sequências de operações dentro de um JOB, e é aqui que quase tudo funciona, pois podemos adicionar TASK, BASH, POWERSHELL, SCRIPT e muito mais.&lt;/li>
&lt;/ul>
&lt;p>E não é necessário seguir a estrutura — posso usar somente o job ou o stage em uma pipeline.&lt;/p>
&lt;p>Vamos brincar, aí explico outros detalhes da pipeline no exemplo que vou montar. Para isso, vou criar um projeto do zero.
Gosto do repositório de exemplos da Microsoft, pois contém exemplos de aplicações de quase todas as linguagens. Vou criar um FORK dela em meu Azure repo. &lt;a href="https://github.com/microsoft/devops-project-samples">https://github.com/microsoft/devops-project-samples&lt;/a>.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 183;
flex-basis: 439px"
>
&lt;a href="https://rehzende.dev/p/2-drops-azure-pipelines-estrutura/new-repo.gif" data-size="1920x1048">
&lt;img src="https://rehzende.dev/p/2-drops-azure-pipelines-estrutura/new-repo.gif"
width="1920"
height="1048"
srcset="https://rehzende.dev/p/2-drops-azure-pipelines-estrutura/new-repo_hu7626da8a222eeab23586e1c7eaf9254c_5082806_480x0_resize_box.gif 480w, https://rehzende.dev/p/2-drops-azure-pipelines-estrutura/new-repo_hu7626da8a222eeab23586e1c7eaf9254c_5082806_1024x0_resize_box.gif 1024w"
loading="lazy"
alt="Criando um Repo">
&lt;/a>
&lt;figcaption>Criando um Repo&lt;/figcaption>
&lt;/figure>&lt;/p></description></item></channel></rss>